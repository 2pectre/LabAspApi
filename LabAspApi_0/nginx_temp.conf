worker_processes auto;

events {
    worker_connections 1024;
}

http {
    error_log /var/log/nginx/error.log error;
    access_log off;

    upstream labaspapi {
        server labaspapi_{{labaspapi_env}}:5000;
    }

    upstream labaspapi_aaaa {
        server labaspapi_aaaa_{{labaspapi_aaaa_env}}:5000;
    }

    upstream labaspapi_bbbb {
        server labaspapi_bbbb_{{labaspapi_bbbb_env}}:5000;
    }

    upstream labaspapi_cccc {
        server labaspapi_cccc_{{labaspapi_cccc_env}}:5000;
    }

    server {
        listen 8080;

        server_name serverwill.net;

        include /etc/nginx/common/proxy_common.conf;

        location /0/ {
            proxy_pass http://labaspapi/;
        }

        location /aaa/ {
            proxy_pass http://labaspapi_aaaa/;
        }

        location /bbb/ {
            proxy_pass http://labaspapi_bbbb/;
        }

        location /ccc/ {
            proxy_pass http://labaspapi_cccc/;
        }

        location = /favicon.ico {
            log_not_found off;
            return 204;
        }

        location / {
            deny all;
            error_log /dev/null emerg;
        }
    }
}
